import{parse as x,stringify as m}from"querystring";var t=class{static utf16decode(e){let c=e.length,n=[],r=0,o,i;for(;r<c;){if(o=e.charCodeAt(r++),(o&63488)===55296){if(i=e.charCodeAt(r++),(o&64512)!==55296||(i&64512)!==56320)throw new RangeError("Punycode UTF-16 decode, illegal UTF-16 sequence");o=((o&1023)<<10)+(i&1023)+65536}n.push(o)}return n}static utf16encode(e){let c=e.length,n=[],r=0,o;for(;r<c;){if(o=e[r++],(o&63488)===55296)throw new RangeError("Punycode UTF-16 encode, illegal UTF-16 value");o>65535&&(o-=65536,n.push(String.fromCharCode(o>>>10&1023|55296)),o=56320|o&1023),n.push(String.fromCharCode(o))}return n.join("")}static decodeDigit(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:t.BASE}static encodeDigit(e,c){return e+22+75*(e<26)-((c!==0)<<5)}static adapt(e,c,n=!1){let r;for(e=n?Math.floor(e/t.DAMP):e>>1,e+=Math.floor(e/c),r=0;e>(t.BASE-t.T_MIN)*t.T_MAX>>1;r+=t.BASE)e=Math.floor(e/(t.BASE-t.T_MIN));return Math.floor(r+(t.BASE-t.T_MIN+1)*e/(e+t.SKEW))}static encodeBasic(e,c=!1){return e-=(e-97<26)<<5,e+((!c&&e-65<26)<<5)}static decode(e,c=!0){let n=[],r=[],o=e.length,i,p,d,l,h,I,M,g,u,A,T,E=t.INITIAL_N,a=0;for(p=t.INITIAL_BIAS,d=e.lastIndexOf(t.DELIMITER),d<0&&(d=0),l=0;l<d;++l){if(c&&(r[n.length]=e.charCodeAt(l)-65<26),e.charCodeAt(l)>=128)throw new RangeError("Punycode illegal input >= 0x80");n.push(e.charCodeAt(l))}for(h=d>0?d+1:0;h<o;){for(I=a,M=1,g=t.BASE;;g+=t.BASE){if(h>=o)throw RangeError("Punycode bad input 1");if(u=t.decodeDigit(e.charCodeAt(h++)),u>=t.BASE)throw RangeError("Punycode bad input 2");if(u>Math.floor((t.MAX_INT-a)/M))throw RangeError("Punycode overflow 1");if(a+=u*M,A=g<=p?t.T_MIN:g>=p+t.T_MAX?t.T_MAX:g-p,u<A)break;if(M>Math.floor(t.MAX_INT/(t.BASE-A)))throw RangeError("Punycode overflow 2");M*=t.BASE-A}if(i=n.length+1,p=t.adapt(a-I,i,I===0),Math.floor(a/i)>t.MAX_INT-E)throw RangeError("Punycode overflow 3");E+=Math.floor(a/i),a%=i,c&&r.splice(a,0,e.charCodeAt(h-1)-65<26),n.splice(a,0,E),a++}if(c)for(a=0,T=n.length;a<T;a++)r[a]&&(n[a]=String.fromCharCode(n[a]).toUpperCase().charCodeAt(0));return t.utf16encode(n)}static encode(e,c=!1){let n,r,o,i,p,d,l,h;c&&(h=t.utf16decode(e));let I=t.utf16decode(e.toLowerCase()),M=I.length;if(c)for(r=0;r<M;r++)h[r]=I[r]!==h[r];let g=[],u=t.INITIAL_N,A=0,T=t.INITIAL_BIAS;for(r=0;r<M;++r)I[r]<128&&g.push(String.fromCharCode(h?t.encodeBasic(I[r],h[r]):I[r]));let E=g.length;for(n=g.length,E>0&&g.push(t.DELIMITER);n<M;){for(o=t.MAX_INT,r=0;r<M;++r)l=I[r],l>=u&&l<o&&(o=l);if(o-u>Math.floor((t.MAX_INT-A)/(n+1)))throw RangeError("Punycode overflow 1");for(A+=(o-u)*(n+1),u=o,r=0;r<M;++r){if(l=I[r],l<u&&++A>t.MAX_INT)throw RangeError("Punycode overflow 2");if(l===u){for(i=A,p=t.BASE;d=p<=T?t.T_MIN:p>=T+t.T_MAX?t.T_MAX:p-T,!(i<d);p+=t.BASE)g.push(String.fromCharCode(t.encodeDigit(d+(i-d)%(t.BASE-d),0))),i=Math.floor((i-d)/(t.BASE-d));g.push(String.fromCharCode(t.encodeDigit(i,c&&h[r]?1:0))),T=t.adapt(A,n+1,n===E),A=0,++n}}++A,++u}return g.join("")}static toAscii(e,c=!0){let n=e.split("."),r=[];for(let o=0;o<n.length;++o){let i=n[o];r.push(i.match(/[^A-Za-z0-9-]/)?"xn--"+t.encode(i,c):i)}return r.join(".")}static toUnicode(e,c=!0){let n=e.split("."),r=[];for(let o=0;o<n.length;++o){let i=n[o];r.push(i.match(/^xn--/)?t.decode(i.slice(4),c):i)}return r.join(".")}},f=t;f.BASE=36,f.DAMP=700,f.DELIMITER="-",f.INITIAL_BIAS=72,f.INITIAL_N=128,f.MAX_INT=2147483647,f.SKEW=38,f.T_MAX=26,f.T_MIN=1;function N(s,e=s,c=!0,n=!0){try{let r;if(c?r=m({"":f.toAscii(s)},void 0," ").trim():r=f.toAscii(s),r===`xn--${s}`||r===`xn--${s}-`)return s;if(c&&n&&(s.includes("@")||s.includes("#"))){let o=s.replace(/@/g,"").replace(/#/g,""),i=r.replace(/%40/g,"").replace(/%23/g,"").replace(/[-.]+/g,".");if(i===`xn.${o}`||i===`xn.${o}-`)return s}return r}catch{return e}}function w(s,e=s,c=!0){try{return c?f.toUnicode(Object.keys(x(s))[0]):f.toUnicode(s)}catch{return e}}export{w as asciiToUnicode,N as unicodeToAscii};
