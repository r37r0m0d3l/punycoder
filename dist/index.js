import{parse as x,stringify as b}from"querystring";var r=class{static utf16decode(t){let n=[],o=0,i=t.length,e,c;for(;o<i;){if(e=t.charCodeAt(o++),(e&63488)==55296){if(c=t.charCodeAt(o++),(e&64512)!=55296||(c&64512)!=56320)throw new RangeError("Punycode UTF-16 decode, illegal UTF-16 sequence");e=((e&1023)<<10)+(c&1023)+65536}n.push(e)}return n}static utf16encode(t){let n=[],o=0,i=t.length,e;for(;o<i;){if(e=t[o++],(e&63488)==55296)throw new RangeError("Punycode UTF-16 encode, illegal UTF-16 value");e>65535&&(e-=65536,n.push(String.fromCharCode(e>>>10&1023|55296)),e=56320|e&1023),n.push(String.fromCharCode(e))}return n.join("")}static decodeDigit(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:r.BASE}static encodeDigit(t,n){return t+22+75*(t<26)-((n!=0)<<5)}static adapt(t,n,o=!1){let i;for(t=o?Math.floor(t/r.DAMP):t>>1,t+=Math.floor(t/n),i=0;t>(r.BASE-r.T_MIN)*r.T_MAX>>1;i+=r.BASE)t=Math.floor(t/(r.BASE-r.T_MIN));return Math.floor(i+(r.BASE-r.T_MIN+1)*t/(t+r.SKEW))}static encodeBasic(t,n=!1){return t-=(t-97<26)<<5,t+((!n&&t-65<26)<<5)}static decode(t,n=!0){let o=[],i=[],e=t.length,c,g,h,l,d,M,u,I,A,p,T,E=r.INITIAL_N,a=0;for(g=r.INITIAL_BIAS,h=t.lastIndexOf(r.DELIMITER),h<0&&(h=0),l=0;l<h;++l){if(n&&(i[o.length]=t.charCodeAt(l)-65<26),t.charCodeAt(l)>=128)throw new RangeError("Punycode illegal input >= 0x80");o.push(t.charCodeAt(l))}for(d=h>0?h+1:0;d<e;){for(M=a,u=1,I=r.BASE;;I+=r.BASE){if(d>=e)throw RangeError("Punycode bad input 1");if(A=r.decodeDigit(t.charCodeAt(d++)),A>=r.BASE)throw RangeError("Punycode bad input 2");if(A>Math.floor((r.MAX_INT-a)/u))throw RangeError("Punycode overflow 1");if(a+=A*u,p=I<=g?r.T_MIN:I>=g+r.T_MAX?r.T_MAX:I-g,A<p)break;if(u>Math.floor(r.MAX_INT/(r.BASE-p)))throw RangeError("Punycode overflow 2");u*=r.BASE-p}if(c=o.length+1,g=r.adapt(a-M,c,M===0),Math.floor(a/c)>r.MAX_INT-E)throw RangeError("Punycode overflow 3");E+=Math.floor(a/c),a%=c,n&&i.splice(a,0,t.charCodeAt(d-1)-65<26),o.splice(a,0,E),a++}if(n)for(a=0,T=o.length;a<T;a++)i[a]&&(o[a]=String.fromCharCode(o[a]).toUpperCase().charCodeAt(0));return r.utf16encode(o)}static encode(t,n=!1){let o,i,e,c,g,h,l,d,M;n&&(M=r.utf16decode(t));let u=r.utf16decode(t.toLowerCase()),I=u.length;if(n)for(e=0;e<I;e++)M[e]=u[e]!=M[e];let A=[],p=r.INITIAL_N,T=0,E=r.INITIAL_BIAS;for(e=0;e<I;++e)u[e]<128&&A.push(String.fromCharCode(M?r.encodeBasic(u[e],M[e]):u[e]));for(o=i=A.length,i>0&&A.push(r.DELIMITER);o<I;){for(c=r.MAX_INT,e=0;e<I;++e)d=u[e],d>=p&&d<c&&(c=d);if(c-p>Math.floor((r.MAX_INT-T)/(o+1)))throw RangeError("Punycode overflow 1");for(T+=(c-p)*(o+1),p=c,e=0;e<I;++e){if(d=u[e],d<p&&++T>r.MAX_INT)throw RangeError("Punycode overflow 2");if(d==p){for(g=T,h=r.BASE;l=h<=E?r.T_MIN:h>=E+r.T_MAX?r.T_MAX:h-E,!(g<l);h+=r.BASE)A.push(String.fromCharCode(r.encodeDigit(l+(g-l)%(r.BASE-l),0))),g=Math.floor((g-l)/(r.BASE-l));A.push(String.fromCharCode(r.encodeDigit(g,n&&M[e]?1:0))),E=r.adapt(T,o+1,o==i),T=0,++o}}++T,++p}return A.join("")}static toAscii(t,n=!0){let o=t.split("."),i=[];for(let e=0;e<o.length;++e){let c=o[e];i.push(c.match(/[^A-Za-z0-9-]/)?"xn--"+r.encode(c,n):c)}return i.join(".")}static toUnicode(t,n=!0){let o=t.split("."),i=[];for(let e=0;e<o.length;++e){let c=o[e];i.push(c.match(/^xn--/)?r.decode(c.slice(4),n):c)}return i.join(".")}},s=r;s.INITIAL_N=128,s.INITIAL_BIAS=72,s.DELIMITER="-",s.BASE=36,s.DAMP=700,s.T_MIN=1,s.T_MAX=26,s.SKEW=38,s.MAX_INT=2147483647;function S(f,t=f,n=!0,o=!0){try{let i;if(n?i=b({"":s.toAscii(f)},void 0," ").trim():i=s.toAscii(f),i===`xn--${f}`||i===`xn--${f}-`)return f;if(n&&o&&(f.includes("@")||f.includes("#"))){let e=f.replace(/@/g,"").replace(/#/g,""),c=i.replace(/%40/g,"").replace(/%23/g,"").replace(/[-.]+/g,".");if(console.dir({clean:e,skip:c}),c===`xn.${e}`||c===`xn.${e}-`)return f}return i}catch{return t}}function N(f,t=f,n=!0){try{return n?s.toUnicode(Object.keys(x(f))[0]):s.toUnicode(f)}catch{return t}}export{N as asciiToUnicode,S as unicodeToAscii};
